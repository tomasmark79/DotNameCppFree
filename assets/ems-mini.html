<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <title>Digitalspace.name</title>
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='16' ry='16' fill='%23111'/%3E%3Ctext x='50' y='60' font-size='40' text-anchor='middle' fill='%23fff' font-family='Arial,Helvetica,sans-serif'%3EDot%3C/text%3E%3C/svg%3E">
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: #ffffff00;
      }
      body {
        width: 100vw;
        height: 100vh;
        display: flex;
        align-items: stretch;
        justify-content: stretch;
      }
      canvas {
        display: block;
        width: 100vw;
        height: 100vh;
        background: #ffffff00;
      }
      #console {
        position: absolute;
        bottom: 10px;
        left: 10px;
        right: 10px;
        max-height: 300px;
        background: rgba(255, 255, 255, 0);
        color: #00ff00;
        font-family: 'Courier New', monospace;
        font-size: 10px;
        padding: 10px;
        border-radius: 5px;
        overflow-y: auto;
        z-index: 9999;
        pointer-events: auto;
        border: 1px solid rgba(0, 255, 0, 0.3);
        box-shadow: 0 0 10px rgba(210, 212, 214, 0.5);
      }
      #console .log-line {
        margin: 2px 0;
        white-space: pre-wrap;
        word-break: break-word;
        text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);      }
    </style>
  </head>
  <body>
    <div id="logo-container" style="position:absolute;top:0;left:0;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;pointer-events:none;z-index:10;">
      <img id="logo-img" alt="DotName Logo" style="max-width:30vw;max-height:30vh;opacity:0.8;" />
    </div>
    <canvas id="canvas" tabindex="-1"></canvas>
    <div id="console"></div>
    <script type="text/javascript">
      var canvas = document.getElementById('canvas');
      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      window.addEventListener('resize', resizeCanvas);
      resizeCanvas();

      var Module = {
        canvas: canvas,
        print: function(text) {
          // Capture stdout from C++ and display in console
          addToConsole(text, 'stdout');
        },
        printErr: function(text) {
          // Capture stderr from C++ and display in console
          addToConsole(text, 'stderr');
        },
        onRuntimeInitialized: function() {
          // Load SVG from Emscripten virtual filesystem
          try {
            const svgData = FS.readFile('share/DotNameStandalone/assets/DotNameLogoV2.svg', { encoding: 'utf8' });
            const dataUrl = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svgData);
            const logoImg = document.getElementById('logo-img');
            if (logoImg) {
              logoImg.src = dataUrl;
            }
          } catch (error) {
            console.warn('Could not load SVG from virtual filesystem:', error);
          }
        }
      };

      // Function to add text to the console div
      function addToConsole(text, type) {
        // Also log to browser developer console
        if (type === 'stderr') {
          console.error(text);
        } else {
          console.log(text);
        }
        
        const consoleDiv = document.getElementById('console');
        if (consoleDiv && text.trim()) {
          const line = document.createElement('div');
          line.className = 'log-line';
          line.style.color = type === 'stderr' ? '#ff6666' : '#3a3f89';
          line.textContent = text;
          consoleDiv.appendChild(line);
          
          // Auto-scroll to bottom
          consoleDiv.scrollTop = consoleDiv.scrollHeight;
          
          // Limit number of lines to prevent memory issues
          if (consoleDiv.children.length > 100) {
            consoleDiv.removeChild(consoleDiv.firstChild);
          }
        }
      }
    </script>
    {{{ SCRIPT }}}
  </body>
</html>